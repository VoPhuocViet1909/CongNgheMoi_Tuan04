<div class="hero">
  <div class="hero__overlay"></div>
  <div class="hero__content">
    <div class="eyebrow">AWS DYNAMODB & S3</div>
    <h1>Qu·∫£n l√Ω S·∫£n ph·∫©m</h1>
    <p class="subtitle">T√¨m ki·∫øm, l·ªçc v√† qu·∫£n l√Ω s·∫£n ph·∫©m m·ªôt c√°ch d·ªÖ d√†ng</p>
    <a href="/products/new" class="btn solid">‚ûï Th√™m s·∫£n ph·∫©m m·ªõi</a>
  </div>
</div>

<div class="panel">
  <div class="panel__head">
    <div>
      <h2>Danh s√°ch s·∫£n ph·∫©m</h2>
      <% if (usedIndex) { %>
        <p class="muted">üîç S·ª≠ d·ª•ng index: <strong><%= usedIndex %></strong></p>
      <% } %>
    </div>
  </div>

  <!-- Filter Form -->
  <form action="/" method="GET" class="filter">
    <div class="field">
      <input 
        type="text" 
        name="q" 
        placeholder="üîç T√¨m ki·∫øm s·∫£n ph·∫©m..."
        value="<%= filters.q || '' %>"
      >
    </div>

    <div class="field">
      <select name="categoryId">
        <option value="">T·∫•t c·∫£ danh m·ª•c</option>
        <% categories.forEach(cat => { %>
          <option value="<%= cat.categoryId %>" <%= filters.categoryId === cat.categoryId ? 'selected' : '' %>>
            <%= cat.name %>
          </option>
        <% }) %>
      </select>
    </div>

    <div class="field">
      <input 
        type="number" 
        name="priceMin" 
        placeholder="Gi√° t·ª´"
        value="<%= filters.priceMin || '' %>"
      >
    </div>

    <div class="field">
      <input 
        type="number" 
        name="priceMax" 
        placeholder="Gi√° ƒë·∫øn"
        value="<%= filters.priceMax || '' %>"
      >
    </div>

    <div class="field">
      <button type="submit" class="btn ghost" style="width: 100%;">L·ªçc</button>
    </div>
  </form>

  <% if (products.length === 0) { %>
    <div style="padding: 64px; text-align: center;">
      <p style="color: var(--muted); font-size: 18px;">Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m n√†o.</p>
      <a href="/" class="link">X√≥a b·ªô l·ªçc</a>
    </div>
  <% } else { %>
    <div class="table-wrap">
      <table class="table">
        <thead>
          <tr>
            <th>H√¨nh ·∫£nh</th>
            <th>T√™n s·∫£n ph·∫©m</th>
            <th>Danh m·ª•c</th>
            <th>Gi√°</th>
            <th>S·ªë l∆∞·ª£ng</th>
            <th>Thao t√°c</th>
          </tr>
        </thead>
        <tbody>
          <% products.forEach(product => { %>
            <tr>
              <td>
                <% if (product.url_image) { %>
                  <img src="<%= product.url_image %>" alt="<%= product.name %>" class="thumb">
                <% } else { %>
                  <div class="thumb" style="display: flex; align-items: center; justify-content: center; font-size: 24px;">
                    üì¶
                  </div>
                <% } %>
              </td>
              <td><strong><%= product.name %></strong></td>
              <td>
                <% if (product.categoryName) { %>
                  <span class="badge success"><%= product.categoryName %></span>
                <% } else { %>
                  <span style="color: var(--muted);">‚Äî</span>
                <% } %>
              </td>
              <td style="color: var(--accent-2); font-weight: 600;">
                <%= Number(product.price).toLocaleString('vi-VN') %> ‚Ç´
              </td>
              <td>
                <% if (product.inventoryStatus === 'out') { %>
                  <span class="badge danger">
                    ‚ùå H·∫øt h√†ng (<%= product.quantity %>)
                  </span>
                <% } else if (product.inventoryStatus === 'low') { %>
                  <span class="badge warning">
                    ‚ö†Ô∏è S·∫Øp h·∫øt (<%= product.quantity %>)
                  </span>
                <% } else { %>
                  <span class="badge success">
                    ‚úÖ C√≤n h√†ng (<%= product.quantity %>)
                  </span>
                <% } %>
              </td>
              <td>
                <div class="row-actions">
                  <a href="/products/<%= product.id %>/edit" class="link">‚úèÔ∏è S·ª≠a</a>
                  <form action="/products/<%= product.id %>?_method=DELETE" method="POST">
                    <button 
                      type="submit" 
                      class="link danger"
                      onclick="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a s·∫£n ph·∫©m n√†y?')"
                    >
                      üóëÔ∏è X√≥a
                    </button>
                  </form>
                </div>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <div class="pagination">
      <% if (pagination.currentPage > 1) { %>
        <a href="/?<%= pagination.prevQuery %>" class="btn ghost">
          ‚Üê Trang tr∆∞·ªõc
        </a>
      <% } else { %>
        <a href="#" class="btn ghost" aria-disabled="true">‚Üê Trang tr∆∞·ªõc</a>
      <% } %>
      
      <span>
        Trang <strong><%= pagination.currentPage %></strong> / <%= pagination.totalPages %>
      </span>
      
      <% if (pagination.currentPage < pagination.totalPages) { %>
        <a href="/?<%= pagination.nextQuery %>" class="btn ghost">
          Trang sau ‚Üí
        </a>
      <% } else { %>
        <a href="#" class="btn ghost" aria-disabled="true">Trang sau ‚Üí</a>
      <% } %>
    </div>
  <% } %>
</div>
